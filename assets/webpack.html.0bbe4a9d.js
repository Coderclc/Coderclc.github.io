import{_ as c,o as i,c as r,a as e,b as o,d as s,e as a,r as t}from"./app.a81d06d1.js";const p={},d={id:"webpack",tabindex:"-1"},h=e("a",{class:"header-anchor",href:"#webpack","aria-hidden":"true"},"#",-1),u=s(" Webpack "),m=a(`<h2 id="install" tabindex="-1"><a class="header-anchor" href="#install" aria-hidden="true">#</a> Install</h2><div class="language-javascript ext-js"><pre class="shiki" style="background-color:#1E1E1E;"><code><span class="line"><span style="color:#9CDCFE;">webpack</span><span style="color:#D4D4D4;"> </span><span style="color:#9CDCFE;">below</span><span style="color:#D4D4D4;"> </span><span style="color:#B5CEA8;">4.0</span><span style="color:#D4D4D4;"> ./</span><span style="color:#9CDCFE;">src</span><span style="color:#D4D4D4;">/</span><span style="color:#9CDCFE;">index</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">js</span><span style="color:#D4D4D4;"> ./</span><span style="color:#9CDCFE;">dist</span><span style="color:#D4D4D4;">/</span><span style="color:#9CDCFE;">bundle</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">js</span><span style="color:#D4D4D4;"> -&gt;</span><span style="color:#9CDCFE;">bundle</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">js</span></span>
<span class="line"><span style="color:#B5CEA8;">4.0</span><span style="color:#D4D4D4;"> </span><span style="color:#9CDCFE;">and</span><span style="color:#D4D4D4;"> </span><span style="color:#9CDCFE;">above</span><span style="color:#D4D4D4;"> </span><span style="color:#9CDCFE;">also</span><span style="color:#D4D4D4;"> </span><span style="color:#9CDCFE;">requires</span><span style="color:#D4D4D4;"> </span><span style="color:#9CDCFE;">webcli</span><span style="color:#D4D4D4;"> </span><span style="color:#9CDCFE;">webpack</span><span style="color:#D4D4D4;"> ./</span><span style="color:#9CDCFE;">src</span><span style="color:#D4D4D4;">/</span><span style="color:#9CDCFE;">index</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">js</span><span style="color:#D4D4D4;"> -</span><span style="color:#9CDCFE;">o</span><span style="color:#D4D4D4;"> ./</span><span style="color:#9CDCFE;">dist</span><span style="color:#D4D4D4;"> -&gt;</span><span style="color:#9CDCFE;">main</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">js</span></span>
<span class="line"></span></code></pre></div><p>4.0 and above install <code>&quot;webpack-cli&quot;: &quot;^4.1.0&quot;</code></p><p>By default running node_modules through script script to find locally</p><div class="language-json ext-json"><pre class="shiki" style="background-color:#1E1E1E;"><code><span class="line"><span style="color:#6A9955;">// webpack will look for webpack.config.js in the root directory</span></span>
<span class="line"><span style="color:#CE9178;">&quot;scripts&quot;</span><span style="color:#D4D4D4;">: {</span></span>
<span class="line"><span style="color:#9CDCFE;">&quot;start&quot;</span><span style="color:#D4D4D4;">: </span><span style="color:#CE9178;">&quot;webpack&quot;</span></span>
<span class="line"><span style="color:#D4D4D4;">}</span></span>
<span class="line"></span></code></pre></div><h2 id="getting-started" tabindex="-1"><a class="header-anchor" href="#getting-started" aria-hidden="true">#</a> Getting started</h2>`,6),b=s("Remove the "),_=e("code",null,"main",-1),f=s(" entry. This prevents accidental release of your code. "),y={href:"https://docs.npmjs.com/files/package.json",target:"_blank",rel:"noopener noreferrer"},g=s("npm"),D=e("p",null,[e("code",null,"<script>"),s(" tag management project problem")],-1),w=e("ol",null,[e("li",null,"Implicit dependencies, which cannot be reflected immediately, the execution of the script depends on the external library (external library)"),e("li",null,"If the dependency does not exist, or if the sequence error is introduced, the application will not function properly"),e("li",null,"If a dependency is imported but not used, the browser will be forced to download useless code")],-1),k=e("code",null,"npx webpack",-1),v=s(", will take our script as "),C={href:"https://www.webpackjs.com/concepts/entry-points",target:"_blank",rel:"noopener noreferrer"},E=s("entry-points"),x=s(", and [output]("),j={href:"https://www.webpackjs.com/concepts/",target:"_blank",rel:"noopener noreferrer"},F=s("https://www.webpackjs.com/concepts/"),q=s(" output) as "),T=e("code",null,"main.js",-1),N=s(". The "),A=e("code",null,"npx",-1),z=s(" command provided by Node 8.2+ can run webpack binaries in the initially installed webpack package"),S=a(`<p><em>Note that backslashes must be used when calling _ <code>webpack</code> _ via the calling path on Windows. For example _ <code>node_modules\\.bin\\webpack --config webpack.config.js</code></em>. _</p><p><em>Custom arguments can be passed to webpack by adding two dashes between the <code>npm run build</code></em> command and your arguments, for example: <em><code>npm run build -- --colors</code></em>. _</p><h2 id="manage-resources" tabindex="-1"><a class="header-anchor" href="#manage-resources" aria-hidden="true">#</a> Manage resources</h2><p>Dynamically package all dependencies, <em>introduce any other type of file</em> through the loader.</p><div class="language-javascript ext-js"><pre class="shiki" style="background-color:#1E1E1E;"><code><span class="line"><span style="color:#D4D4D4;">{</span></span>
<span class="line"><span style="color:#C8C8C8;">test</span><span style="color:#D4D4D4;">:</span><span style="color:#D16969;"> /</span><span style="color:#D7BA7D;">\\.</span><span style="color:#CE9178;">(</span><span style="color:#D16969;">png</span><span style="color:#DCDCAA;">|</span><span style="color:#D16969;">svg</span><span style="color:#DCDCAA;">|</span><span style="color:#D16969;">jpeg</span><span style="color:#DCDCAA;">|</span><span style="color:#D16969;">gif</span><span style="color:#CE9178;">)</span><span style="color:#DCDCAA;">$</span><span style="color:#D16969;">/</span><span style="color:#D4D4D4;">,</span></span>
<span class="line"><span style="color:#C8C8C8;">use</span><span style="color:#D4D4D4;">: [{</span></span>
<span class="line"><span style="color:#9CDCFE;">loader:</span><span style="color:#D4D4D4;"> </span><span style="color:#CE9178;">&#39;file-loader&#39;</span><span style="color:#D4D4D4;">,</span></span>
<span class="line"><span style="color:#9CDCFE;">options:</span><span style="color:#D4D4D4;"> {</span></span>
<span class="line"><span style="color:#9CDCFE;">outputPath:</span><span style="color:#D4D4D4;"> </span><span style="color:#CE9178;">&#39;./img&#39;</span></span>
<span class="line"><span style="color:#6A9955;">// publicPath: &#39;./img&#39;</span></span>
<span class="line"><span style="color:#D4D4D4;">}</span></span>
<span class="line"><span style="color:#D4D4D4;">}]</span></span>
<span class="line"><span style="color:#D4D4D4;">}</span></span>
<span class="line"></span></code></pre></div><p>webpack decides which files to use which loaders based on regular expression matching</p><p>By default, css will be injected into the main.js file. In most cases, css separation (using the extract-text-webpack-plugin plugin) is conducive to improving the loading speed of the production environment.</p><p><code>use: [ &#39;style-loader&#39;, &#39;css-loader&#39; ]</code>The order is important, the loading order is right-to-do</p>`,8),P=s("Load Css "),B={href:"https://www.webpackjs.com/loaders/style-loader",target:"_blank",rel:"noopener noreferrer"},I=s("style-loader"),V=s(" (inject css-loader internal styles into our HTML page) and [css-loader](https:/ /www.webpackjs.com/loaders/css-loader) (loads .css files):"),M=e("li",null,[e("p",null,"file-loader, load images, fonts and transfer them to the dist folder")],-1),W=s("When the file size is small, you can use "),L=e("code",null,"url-loader",-1),H=s(" The function is similar to "),O={href:"https://github.com/webpack-contrib/file-loader",target:"_blank",rel:"noopener noreferrer"},U=e("code",null,"file-loader",-1),R=s(", but the file size (unit byte) is lower A DataURL can be returned when the specified limit is exceeded."),J=s("Load data such as JSON files, CSV, TSV and XML using "),G={href:"https://github.com/theplatapi/csv-loader",target:"_blank",rel:"noopener noreferrer"},X=s("csv-loader"),Y=s(" and [xml-loader]("),$={href:"https://github.com/gisikw",target:"_blank",rel:"noopener noreferrer"},K=s("https://github.com/gisikw"),Q=s(" /xml-loader). Let's deal with these three types of files:"),Z=e("p",null,"Before webpack, front-end developers used tools like grunt and gulp to process assets",-1),ee=e("ol",{start:"5"},[e("li",null,"url loader limit: When the size of the image kb*1024 is less than the limit, the image will be compiled into a bae64 string and saved directly in the file. If it is larger than the file loader, the image will be packaged into dist")],-1),se=e("h2",{id:"manage-output",tabindex:"-1"},[e("a",{class:"header-anchor",href:"#manage-output","aria-hidden":"true"},"#"),s(" manage output")],-1),oe=e("p",null,"Once you start hashing filenames and exporting multiple bundles, you need to manually mount multiple bundles to index.html, and everything becomes difficult.",-1),ne=e("p",null,"Use HtmlWebpackPlugin to manage output HtmlWebpackPlugin will generate index.html file by default. That said, it will replace our original with the newly generated index.html file. The new index.html imports all bundle.js",-1),ae=e("p",null,[s("Use clean-webpack-plugin to clean dist folder before every bundle "),e("code",null,"const { CleanWebpackPlugin } = require('clean-webpack-plugin')")],-1),te=e("p",null,"Use HtmlWebpackPlugin html to automatically associate packaged js files",-1),le=s("Clean the folder with "),ce={href:"https://www.npmjs.com/package/clean-webpack-plugin",target:"_blank",rel:"noopener noreferrer"},ie=e("code",null,"clean-webpack-plugin",-1),re=a(`<p>webpack and its plugins seem to &quot;know&quot; which files should be generated. The answer is, through manifest</p><h2 id="development" tabindex="-1"><a class="header-anchor" href="#development" aria-hidden="true">#</a> development</h2><p>source map source files will be packaged and integrated into a bundle.js, it is difficult to track which source file errors and warnings come from</p><p>Choose a watch development tool</p><ol><li>webpack&#39;s Watch Mode &quot;watch&quot;: &quot;webpack --watch&quot;, repack when code modification is detected</li><li>webpack-dev-server webpack-cli@3</li><li>webpack-dev-middleware</li></ol><p>webpack server only needs to be configured</p><div class="language-javascript ext-js"><pre class="shiki" style="background-color:#1E1E1E;"><code><span class="line"><span style="color:#C8C8C8;">devServer</span><span style="color:#D4D4D4;">: {</span></span>
<span class="line"><span style="color:#C8C8C8;">contentBase</span><span style="color:#D4D4D4;">: </span><span style="color:#CE9178;">&#39;./dist&#39;</span></span>
<span class="line"><span style="color:#D4D4D4;">}</span></span>
<span class="line"></span></code></pre></div><p>The above configuration tells <code>webpack-dev-server</code> to create a service under <code>localhost:8080</code>, and use the files in the <code>dist</code> directory as accessible files.</p><p>The bundle.js file generated by webpack-dev-server packaged for us is not placed on the actual physical disk; it is directly hosted in the computer&#39;s memory, so we cannot find this package in the project root directory at all good bundle.js;</p><p><code>webpack-dev-middleware</code> is a container (wrapper) that can pass webpack processed files to a server (server). <code>webpack-dev-server</code> uses it internally, and at the same time, it is also available as a separate package for more customization to achieve more needs. Combined with server, koa,</p><div class="language-javascript ext-js"><pre class="shiki" style="background-color:#1E1E1E;"><code><span class="line"><span style="color:#569CD6;">const</span><span style="color:#D4D4D4;"> </span><span style="color:#4FC1FF;">config</span><span style="color:#D4D4D4;"> = </span><span style="color:#DCDCAA;">require</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&#39;./webpack.config.js&#39;</span><span style="color:#D4D4D4;">)</span></span>
<span class="line"><span style="color:#569CD6;">const</span><span style="color:#D4D4D4;"> </span><span style="color:#4FC1FF;">compiler</span><span style="color:#D4D4D4;"> = </span><span style="color:#DCDCAA;">webpack</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">config</span><span style="color:#D4D4D4;">) </span><span style="color:#9CDCFE;">generates</span><span style="color:#D4D4D4;"> </span><span style="color:#9CDCFE;">a</span><span style="color:#D4D4D4;"> </span><span style="color:#9CDCFE;">compiler</span></span>
<span class="line"></span></code></pre></div><h2 id="module-hot-swap" tabindex="-1"><a class="header-anchor" href="#module-hot-swap" aria-hidden="true">#</a> Module hot swap</h2><p>HMR Hot Module Replacement which allows various modules to be updated at runtime without a full refresh</p><p>Never enable plugins imported by HMR in production environment will make the bundle very large</p><p>When using both the webpack dev server and the Node.js API, do not put the dev server option in the webpack config object. Instead, when creating the option, pass it as the second parameter. That is, when webpack-dev-server and webpack-dev-middleware are used in combination with server</p><p>Module hot replacement of js files needs to use module.hot.accept to monitor and modify css, hmr is very easy, the loader will <code>module.hot.accept</code> in the background to patch (patch) <code>&lt;style&gt;</code> tags.</p><h2 id="tree-shaking" tabindex="-1"><a class="header-anchor" href="#tree-shaking" aria-hidden="true">#</a> Tree shaking</h2><p>Tree shaking is a term commonly used to describe the removal of dead-code from a JavaScript context.</p><p>The default packaging of webpack5+ is to use the production environment, the default treeshaking, if <code>--mode = development</code> is used, the dead-code will also be packaged into the bundle</p><p>The new official version of webpack 4 extends this detection capability, using the <code>&quot;sideEffects&quot;</code> property of <code>package.json</code> as a marker to provide hints to the compiler, indicating which files in the project are &quot;pure (pure ES2015 modules)&quot; , which allows you to safely delete unused parts of the file.</p><p>Set the field sideEffects to false in package.json, and webpack will safely delete the unused export with the same effect as <code>babel-plugin-import</code></p><p>A &quot;side effect&quot; is defined as code that performs special behavior when imported, rather than just exposing an export or exports. For example, such as polyfills, which affect the global scope and generally do not provide export. Some code fields have side effects, sideEffects can be set as an array</p><p>Compress output, either <em>UglifyJSPlugin</em> set mde export mode, or <code>webpack --mode production</code></p><h2 id="production-build" tabindex="-1"><a class="header-anchor" href="#production-build" aria-hidden="true">#</a> Production build</h2><p>Development environment: We need a powerful source map and localhost server with live reloading or hot module replacement capabilities.</p><p>Production: Smaller bundles, lighter source maps, and more optimized resources to improve load times. Due to logical separation</p><p>Follow the principle of not repeating DRY don&#39;trepeatyourself, extract the common configuration, and use <code>webpack-merge</code> to merge</p><p><code>webpack.base.conf.js webpack.dev.conf.js webpack.prod.conf.js</code></p>`,28),pe=s("The useful Minification plugins "),de={href:"https://github.com/webpack-contrib/babel-minify-webpack-plugin",target:"_blank",rel:"noopener noreferrer"},he=s("babel-minify-webpack-plugin"),ue=s(" and [webpack-closure-compiler]("),me={href:"https://github",target:"_blank",rel:"noopener noreferrer"},be=s("https://github"),_e=s(". com/roman01la/webpack-closure-compiler)"),fe=e("p",null,[s("It is recommended to use "),e("code",null,"devtool: 'source-map'"),s(" in the production environment, which is a map file independent of the bundle file, different from the inlint-source-map in the development environment")],-1),ye=e("p",null,[s("Use "),e("code",null,[s("new webpack.DefinePlugin({ 'p"),e("wbr"),s("rocess.env.NODE_ENV': JSON.stringify('production') })")]),s(" to set the global variable NODE_ENV, scope bundle")],-1),ge=e("em",null,[s("Technically, "),e("em",null,[e("code",null,"NODE_ENV")]),s(" is a system environment variable exposed by Node.js to executing scripts. Used to determine the behavior of server tools, build scripts, and client libraries in development and production (dev-vs-prod) environments. However, as expected, it is not possible to set _ "),e("code",null,[s("p"),e("wbr"),s("rocess.env.NODE_ENV")]),s(" _ to _ "),e("code",null,'"production"')],-1),De=s(" in the build script _ "),we=e("code",null,"webpack.config.js",-1),ke=s(),ve=s(", see _ [#2537] ("),Ce={href:"https://github.com/webpack/webpack/issues/2537",target:"_blank",rel:"noopener noreferrer"},Ee=s("https://github.com/webpack/webpack/issues/2537"),xe=s(")"),je=s(". Therefore, conditional statements such as "),Fe=e("code",null,[s("p"),e("wbr"),s("rocess.env.NODE_ENV === 'production' ? '[name].[hash].bundle.js' : '[name].bundle.js'")],-1),qe=s(" _ are configured in webpack file, doesn't work as expected. _"),Te=e("p",null,[e("strong",null,"split css")],-1),Ne=e("ol",null,[e("li",null,"webpack 4 : mini-css-extract-plugin"),e("li",null,"webpack 3: extract-text-webpack-plugin")],-1),Ae=e("p",null,"css minification: css-minimizer-webpack-plugin",-1),ze=e("h2",{id:"code-separation",tabindex:"-1"},[e("a",{class:"header-anchor",href:"#code-separation","aria-hidden":"true"},"#"),s(" code separation")],-1),Se=e("p",null,"Separating the code into different bundles can then load these files on demand or in parallel. Code separation can be used to obtain smaller bundles and to control resource loading priorities, which can greatly affect loading times if used properly.",-1),Pe=s("Entry Origin: Manually separate code using the "),Be={href:"https://www.webpackjs.com/configuration/entry-context",target:"_blank",rel:"noopener noreferrer"},Ie=e("code",null,"entry",-1),Ve=s(" configuration. Stupid method (repeated, if the entry files depend on each other, they will be imported circularly, not flexible enough)"),Me=s("Prevent duplication: use "),We={href:"https://www.webpackjs.com/plugins/commons-chunk-plugin",target:"_blank",rel:"noopener noreferrer"},Le=e("code",null,"CommonsChunkPlugin",-1),He=s(" . Remove duplicate dependent modules"),Oe=e("li",null,"Dynamic import: code is separated by inline function calls of modules.",-1),Ue=a('<p>ExtractTextPlugin: Used to separate CSS from the main application.</p><p>bundle-loader: Used to separate code and lazy load generated bundles.</p><p>promise-loader: Similar to bundle-loader, but uses promises.</p><p>The CommonsChunkPlugin plugin can also separate vendor modules from application code by using the explicit vendor chunks feature.</p><p>Just configure <code>output chunkFilename: &#39;[name].bundle.js&#39;</code> to separate dynamic imports into a separate <code>bundle /_ webpackChunkName: &quot;lodash&quot; _/</code> named</p><p><strong>bundle analysis</strong></p><ol><li>webpack-chart: webpack data interaction pie chart.</li><li>webpack-visualizer: Visualize and analyze your bundles, check which modules take up space and which may be reused.</li><li>webpack-bundle-analyzer: A plug-in and CLI tool for analyzing bundle content, displaying it to users in a convenient, interactive, and scalable tree diagram.</li></ol><h2 id="lazy-loading" tabindex="-1"><a class="header-anchor" href="#lazy-loading" aria-hidden="true">#</a> lazy loading</h2><p>Lazy loading, or on-demand loading, is a great way to optimize web pages or applications. This method actually separates your code at some logical breakpoints, and then references or is about to reference other new code blocks after completing certain operations in some code blocks. This speeds up the initial loading of the app and reduces its overall size, as some blocks of code may never be loaded.</p><p>As long as the function is introspectively separated by module, the chunk will be separated according to the <code>filename: &#39;bundle.[name].js&#39;, chunkFilename: &#39;[name].bundle.js&#39;</code> naming format</p><h2 id="cache" tabindex="-1"><a class="header-anchor" href="#cache" aria-hidden="true">#</a> cache</h2>',11),Re=s("The packaged /dist is deployed to the server, and the browser can access the website and its resources of this server. Getting resources is time-consuming, so browsers use a technology called "),Je={href:"https://searchstorage.techtarget.com/definition/cache",target:"_blank",rel:"noopener noreferrer"},Ge=s("cache"),Xe=s(". Hitting the cache can reduce network traffic and make the website load faster, however, if we deploy a new version without changing the filename of the resource, the browser may think it has not been updated and will use its cached version . Because of the cache, when you need to fetch new code, it can be tricky. Causes the code to be updated without the browser to reset"),Ye=e("p",null,[s("Set "),e("code",null,"filename: '[name].[chunkhash].js'"),s(" to make the packaged file named differently")],-1);function $e(Ke,Qe){const l=t("NpmBadge"),n=t("ExternalLinkIcon");return i(),r("div",null,[e("h1",d,[h,u,o(l,{package:"webpack"})]),m,e("p",null,[b,_,f,e("a",y,[g,o(n)])]),D,w,e("p",null,[k,v,e("a",C,[E,o(n)]),x,e("a",j,[F,o(n)]),q,T,N,A,z]),S,e("ol",null,[e("li",null,[e("p",null,[P,e("a",B,[I,o(n)]),V])]),M,e("li",null,[e("p",null,[W,L,H,e("a",O,[U,o(n)]),R])]),e("li",null,[e("p",null,[J,e("a",G,[X,o(n)]),Y,e("a",$,[K,o(n)]),Q])])]),Z,ee,se,oe,ne,ae,te,e("p",null,[le,e("a",ce,[ie,o(n)])]),re,e("p",null,[pe,e("a",de,[he,o(n)]),ue,e("a",me,[be,o(n)]),_e]),fe,ye,e("blockquote",null,[e("p",null,[ge,De,we,ke,e("em",null,[ve,e("a",Ce,[Ee,o(n)]),xe]),je,Fe,qe])]),Te,Ne,Ae,ze,Se,e("ol",null,[e("li",null,[Pe,e("a",Be,[Ie,o(n)]),Ve]),e("li",null,[Me,e("a",We,[Le,o(n)]),He]),Oe]),Ue,e("p",null,[Re,e("a",Je,[Ge,o(n)]),Xe]),Ye])}var es=c(p,[["render",$e],["__file","webpack.html.vue"]]);export{es as default};
